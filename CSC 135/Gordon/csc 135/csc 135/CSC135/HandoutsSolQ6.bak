;; The first three lines of this file were inserted by DrRacket. They record metadata
;; about the language level of this file in a form that our tools can easily process.
#reader(lib "htdp-advanced-reader.ss" "lang")((modname HandoutsSolQ6) (read-case-sensitive #t) (teachpacks ()) (htdp-settings #(#t constructor repeating-decimal #t #t none #f () #f)))
(define (atom? a)
  (not (list? a)))

(define (remove_atom x L) ; orignale code
  (cond ( (null? L ) '( ) )
        ( (atom? (car L) ) (if (eq? (car L) x) (cons (remove_atom x (cdr L) ) null )
                               (cons (car L) (remove_atom x (cdr L) ) ) ) )
        ( else (append (remove_atom x (car L) ) (remove_atom x (cdr L) ) ) ) ) )

( remove_atom 'a '( a ( b c ( a ) a ) ( a b ) ) )


(define (remove_atom2 x L) ; fixed code
  (cond ( (null? L ) '( ) )
        ( (atom? (car L) ) (if (eq? (car L) x) (remove_atom2 x (cdr L) ) ; remove the (cons .... null)
                               (cons (car L) (remove_atom2 x (cdr L) ) ) ) )
        ( else (cons (remove_atom2 x (car L) ) (remove_atom2 x (cdr L) ) ) ) ) ) ; use append instead of cons

( remove_atom2 'a '( a ( b c ( a ) a ) ( a b ) ) )